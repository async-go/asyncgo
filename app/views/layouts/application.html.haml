!!! 5
%html{ lang: 'en' }
  = render partial: 'shared/head'
  %body
    %header.px-2.border-bottom.shadow-sm.mb-2
      %nav.navbar.navbar-light.navbar-expand-lg
        .container-fluid
          = link_to root_path, class: 'navbar-brand me-4 border-2',
            data: { controller: 'hotkey', hotkey: 'h' } do
            = image_tag('logo.svg', alt: 'AsyncGo logo', class: 'img-fluid mt-1')
            %span.ms-1.me-5 AsyncGo
          - if current_user&.team
            %span.mt-1
              = link_to new_team_topic_path(current_user.team) do
                .btn.btn-primary.btn-sm
                  = assistive_icon('fas', 'file-medical', 'New Topic', classname: 'px-1 me-1')
                  New Topic
            %span.mt-1.ms-3.me-3.btn.btn-sm.btn-secondary#notifications
              = link_to user_notifications_path(current_user), class: 'text-decoration-none' do
                = assistive_icon('fas', 'bell', 'Has notification', classname: 'text-warning')
                %span.ms-1.text-white= unique_unread_notifications.count
          %button.navbar-toggler.border-0{ type: 'button', 'data-bs-toggle' => 'collapse',
            'data-bs-target' => '#navbar-content', 'aria-controls' => 'navbar-content',
            'aria-expanded' => 'false', 'aria-label' => 'Toggle navigation' }
            %span.mt-1.navbar-toggler-icon
          .collapse.navbar-collapse#navbar-content
            %ul.navbar-nav.ms-auto
              - if current_user
                - if current_user.team
                  %li.pe-3
                    %span.mt-4
                      = form_with(url: team_topics_path(current_user.team), method: :get) do |form|
                        .input-group.mt-1
                          = form.text_field :labels, value: params[:labels],
                            placeholder: 'Separate labels with space',
                            class: 'bg-light form-control form-control-sm', autocomplete: 'false'
                          - if params[:labels].present?
                            .input-group-append
                              = link_to team_topics_path(current_user.team),
                                class: 'btn btn-sm btn-outline-secondary' do
                                = assistive_icon('fas', 'ban', 'Clear Filter')
                          - else
                            .input-group-append
                              = form.button class: 'btn btn-sm btn-secondary', type: 'submit',
                                name: nil do
                                = assistive_icon('fas', 'filter', 'Filter')
                  %li.nav-item.pe-3#admin-nav
                    = link_to edit_team_path(current_user.team_id) do
                      = assistive_icon('fas', 'cog', 'Team Settings',
                        classname: 'btn btn-outline-secondary mt-1')
                - else
                  %li.nav-item.pe-3#create-team-nav
                    = link_to 'Create Team', new_team_path, 'nav-link'
                %li.nav-item.pe-3#profile-nav
                  = link_to edit_user_path(current_user) do
                    = assistive_icon('fas', 'user-cog', 'User Settings',
                      classname: 'btn btn-outline-secondary mt-1')
                %li.nav-item.pe-3#sign-out-nav
                  = link_to sign_out_path, method: :delete do
                    = assistive_icon('fas', 'sign-out-alt', 'Sign Out',
                      classname: 'btn btn-outline-secondary mt-1')
              - else
                %li.nav-item.dropdown#sign-in-nav
                  %a.nav-link.dropdown-toggle{ href: '#', id: 'sign-in-dropdown', role: 'button',
                    'data-bs-toggle': 'dropdown', 'aria-haspopup': 'true',
                    'aria-expanded': 'false' } Sign in
                  %ul.dropdown-menu{ 'aria-labelledby': 'sign-in-dropdown' }
                    %li= button_to 'Sign in with Google', '/auth/google_oauth2',
                      'data-turbo': false, class: 'dropdown-item btn btn-google'
                    %li= button_to 'Sign in with GitHub', '/auth/github',
                      'data-turbo': false, class: 'dropdown-item btn btn-github mt-1'
                    %li= button_to 'Sign in with Microsoft', '/auth/microsoft_graph',
                      'data-turbo': false, class: 'dropdown-item btn btn-microsoft mt-1'
                    %li= button_to 'Sign in with Slack', '/auth/slack',
                      'data-turbo': false, class: 'dropdown-item btn btn-slack mt-1'
              %li.mt-1
                = link_to 'https://asyncgo.com/docs', target: '_blank',
                  rel: 'noopener' do
                  = assistive_icon('fas', 'book', 'Documentation',
                    classname: 'btn btn-outline-secondary')
              %li.mt-1
                = yield :extra_nav_items
    - container = current_user&.preferences&.fluid_layout? ? 'container-fluid' : 'container'
    %main.ps-3.mb-3.mt-4{ role: 'main', class: container }
      - if flash.any?
        .mt-1
          - flash.each do |type, message|
            .alert.alert-dismissible.fade.show{ class: "alert-#{type}", role: 'alert' }
              %span= message
              %button.btn-close{ 'data-bs-dismiss' => 'alert', 'aria-label' => 'close' }
      = yield
