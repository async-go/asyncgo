!!! 5
%html{ lang: 'en' }
  %head
    %title AsyncGo
    %meta{ content: 'text/html; charset=UTF-8', 'http-equiv': 'Content-Type' }
    %meta{ charset: 'utf-8' }
    %meta{ name: 'viewport',
      content: 'width=device-width, initial-scale=1, shrink-to-fit=no' }
    = csrf_meta_tags
    = csp_meta_tag
    %link{ rel: 'stylesheet',
      href: 'https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css',
      integrity: 'sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1',
      crossorigin: 'anonymous' }
    = stylesheet_link_tag 'application', media: 'all',
      'data-turbolinks-track': 'reload'
    = javascript_pack_tag 'application', 'data-turbolinks-track': 'reload'
    = favicon_link_tag image_path('logo.svg')

  %body
    %nav.navbar.navbar-expand-lg.navbar-light.bg-light
      .container-fluid
        %a.navbar-brand{ href: root_path }
          = image_tag('logo.svg', alt: 'AsyncGo')
          %span AsyncGo
        %button.navbar-toggler{ type: 'button', 'data-bs-toggle' => 'collapse',
          'data-bs-target' => '#navbar-content', 'aria-controls' => 'navbar-content',
          'aria-expanded' => 'false', 'aria-label' => 'Toggle navigation' }
          %span.navbar-toggler-icon
        .collapse.navbar-collapse#navbar-content
          - if current_user&.team_id
            %span.badge.bg-secondary.fs-6.me-auto
              Active Team: #{current_user.team.name}
          %ul.navbar-nav.ms-auto.me-2
            %li.nav-item= link_to 'Docs', 'https://docs.asyncgo.com', class: 'nav-link',
              target: :_blank, rel: :noopener
            - if current_user
              - if current_user.team_id
                %li.nav-item= link_to 'Topics', team_topics_path(current_user.team),
                  class: class_names('nav-link',
                    active: current_page?(team_topics_path(current_user.team)))
                %li.nav-item= link_to 'Admin', edit_team_path(current_user.team_id),
                  class: class_names('nav-link',
                  active: current_page?(edit_team_path(current_user.team_id)))
              - else
                %li.nav-item= link_to 'Create Team', new_team_path,
                  class: class_names('nav-link', active: current_page?(new_team_path))
              %li.nav-item= link_to 'Sign out', sign_out_path, method: :delete, class: 'nav-link'
            - else
              %li.nav-item.dropdown
                %a.nav-link.dropdown-toggle{ 'href': '#',
                  'id': 'signinDropdown',
                  'role': 'button',
                  'data-bs-toggle': 'dropdown',
                  'aria-haspopup': 'true',
                  'aria-expanded': 'false' }
                  Sign in
                %ul.dropdown-menu{ 'aria-labelledby': 'signinDropdown' }
                  %li= button_to 'Google', '/auth/google_oauth2',
                    class: 'dropdown-item'
                  %li= button_to 'GitHub', '/auth/github',
                    class: 'dropdown-item'

    %main.container.mt-4{ role: 'main' }
      .sticky-top.mt-2
        - if flash.any?
          - flash.each do |type, message|
            .alert.alert-dismissible.fade.show{ class: "alert-#{type}", role: 'alert' }
              %span= message
              %button.btn-close{ 'data-bs-dismiss' => 'alert', 'aira-lable' => 'close' }
      = yield
    -# haml-lint:disable LineLength
    = javascript_include_tag 'https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js',
      integrity: 'sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj',
      crossorigin: 'anonymous',
      type: 'text/javascript'
    -# haml-lint:disable LineLength
    = javascript_include_tag 'https://consent.cookiebot.com/uc.js',
      id: 'cookiebot',
      type: 'text/javascript',
      'data-cbid': '7e1bb1be-facd-4cd1-aef0-b0198b0ec955',
      'data-blockingmode': 'auto'
